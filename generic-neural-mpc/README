# Real-Time Neural MPC for a Generic System
This project implements the Real-Time Neural MPC (RTN-MPC) strategy for a generic system whose dynamics are modeled entirely by a neural network. It is a generalized version of the concepts presented in the paper "Real-time Neural MPC: Deep Learning Model Predictive Control for Quadrotors and Agile Robotic Platforms".

The core idea is to locally approximate the neural network dynamics at each time step and use these linear approximations within a fast `acados` optimization framework.

## Prerequisites
Follow the installation guide in the original [repo](https://github.com/TUM-AAS/neural-mpc/tree/main?tab=readme-ov-file).
In particular build and install [acados](https://docs.acados.org/installation/index.html)

## env
After acados is built and installed in <acados_root> (e.g. ~/acados), create the venv
```bash
sudo add-apt-repository ppa:deadsnakes/ppa
sudo apt update
sudo apt install python3.9
sudo apt install python3.9-distutils
virtualenv env --python=/usr/bin/python3.9
source env/bin/activate
pip install --use-pep517 -e ~/acados/interfaces/acados_template
export ACADOS_SOURCE_DIR="$HOME/acados"
export LD_LIBRARY_PATH="$HOME/acados/lib:$LD_LIBRARY_PATH"

## How to Run Example
Train the NN, then run the MPC

```bash
python  model/train_example.py
python example.py 
